{% load i18n %}
{% if unavailable %}
    <h4>{% trans 'ERROR: uWSGI is not available!' %}</h4>
{% else %}


<div id="content-main" class="inline-related tabular">
    <div class="module">
    <header class="nice-padding"><h4>{% trans 'Status' %}</h4></header>
        <table class="listing chooser">
            <thead>
                <tr>
                    <th>Option</th>
                    <th>Value</th>
                </tr>
            </thead>
            <tbody>
                {% for key, value in stats %}
                <tr class="{% cycle 'row1' 'row2' %}">
                    <td class="title" scope="row"><h2>{{ key }}</h2></td>
                    <td>{{ value }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    <div class="module">
    <header class="nice-padding"><h4>{% trans 'Options' %}</h4></header>
        <table class="listing chooser">
            <thead>
                <tr>
                    <th>Option</th>
                    <th>Value</th>
                </tr>
            </thead>
            <tbody>
                {% for key, value in options %}
                <tr class="{% cycle 'row1' 'row2' %}">
                    <td class="title" scope="row"><h4>{{ key }}</h4></td>
                    <td>{{ value }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div class="module balanced">
    <header class="nice-padding"><h4>{% trans 'Workers' %}</h4></header>
        <table class="listing chooser">
            <thead>
                <tr>
                    <th>id</th>
                    <th>pid</th>
                    <th>status</th>
                    <th>requests</th>
                    <th>exceptions</th>
                    <th>running time (milliseconds)</th>
                    <th>load</th>
                    <th>last spawn</th>
                    <th>respawn count</th>
                    <th>address space (vsz)</th>
                    <th>resident memory (rss)</th>
                </tr>
            </thead>
            <tbody>
            {% for w in workers %}
                <tr>
                    <td>{{ w.id }}</td>
                    <td>{{ w.pid }}</td>
                    <td>{{ w.status }}</td>
                    <td>{{ w.requests }}</td>
                    <td>{{ w.exceptions }}</td>
                    <td>{{ w.running_time }}</td>
                    <td>{{ w.load|floatformat:2 }} %</td>
                    <td>{{ w.last_spawn }}</td>
                    <td>{{ w.respawn_count }}</td>
                    <td>{{ w.vsz|filesizeformat }}</td>
                    <td>{{ w.rss|filesizeformat }}</td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
    <div class="module balanced">
    <header class="nice-padding"><h4>{% trans 'Spooler jobs' %}</h4></header>
        <table class="listing chooser">

            <thead>
                <tr>
                    <th>job filename</th>
                    <th>environment</th>
                </tr>
            </thead>
            <tbody>
        {% for j in jobs %}
            <tr>
                <td align="left">{{ j.file }}</td>
                <td align="left">{{ j.env }}</td>
            </tr>
        {% endfor %}
            </tbody>
        </table>
    </div>
    
    {% if masterpid %}
    <div class="submit-row">
        <a href="{% url 'uwsgi_reload' %}">{% trans 'Gracefully reload uWSGI' %}</a>
        <a href="{% url 'uwsgi_cache_clear' %}">{% trans 'Clear uWSGI cache' %}</a>
    </div>
    {% endif %}

</div>


{% endif %}